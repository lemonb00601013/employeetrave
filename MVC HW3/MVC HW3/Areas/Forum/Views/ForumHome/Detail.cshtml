@model MVC_HW3.ViewModel.ForumModel
@{
    ViewBag.Title = "  Detail";
}

<h2>Detail</h2>
@section styles{
    <style>

    </style>
}


<div class="col-lg-pull-12">
    <div class="col-lg-4">
        <nav>
            <ul class="nav nav-justified">
                @foreach (var classes in Model.Fclass)
                {
                    <li>@Html.ActionLink(classes.fFC_Class, "Index", "ForumHome", new { id = classes.fFC_ID }, new { @class = "list-group-item" })</li>
                }
            </ul>
        </nav>
    </div>
</div>

<div class="col-lg-pull-12">
    <div class="col-lg-10">
        <div class="panel panel-primary">
            @foreach (var title in Model.Ftitle)
            {
                    <h2>@Html.DisplayFor(p => title.fFT_Title)</h2>
            }
        </div>
    </div>


    <div class="panel panel-primary">
        @foreach (var message in Model.Fmessage.Where(p => p.fFM_Dad == null))
        {
            <div class="col-lg-10">
                <div class="panel panel-primary">
                    @Html.DisplayFor(p => message.tEmployee.fEp_Nickname)
                    <img src="@Url.Action("GetImageByte","ForumHome",new {id = message.fEp_ID})" class="" />
                    <div class="panel panel-primary">
                        @Html.Raw(message.fFM_Content)
                    </div>
                    <p>
                            @Html.DisplayFor(p => message.fFM_Date)
                            @Html.HiddenFor(p => message.fFM_ID)
                            @Html.HiddenFor(p => message.fMC_ID)
                    </p>
                </div>
            </div>

            <div class="col-lg-10">
                <div class="panel panel-primary">
                    <button class="btn btn-primary" id="twitter" title="在下方留言">留言</button>
                    <button class="btn btn-primary" id="message" title="在下方推文">推文</button>
                    <div id="load" hidden="hidden">
                        @Html.Action("partial_twitter", "ForumHome", new { id = message.fFM_ID })
                    </div>
                </div>
            </div>

            <div class="col-lg-10">
                <div class="panel panel-primary">
                    @foreach (var twitter in Model.Fmessage.Where(q => q.fFM_Dad == message.fFM_ID))
                    {
                        <p>@Html.DisplayFor(q => twitter.tEmployee.fEp_Nickname) : @Html.DisplayFor(q => twitter.fFM_Content)  @Html.DisplayFor(q => twitter.fFM_Date) </p>
                    }
                </div>
            </div>
        }
    </div>
</div>



@section scripts{
    <script>
        $(document).ready(function () {

            $('.input').cleditor();

            $(document).on('click', "#twitter", function () {
                $(this).parent().find('#load').slideToggle();
                //$(this).next().next().slideToggle();

                var fmid = $('#message_fFM_ID').val();
                $("#load").load('@Url.Action("partial_twitter", "ForumHome")' + '/' + fmid);
            });

            $(document).on('click', "#message", function () {
                var id = $('#message_fMC_ID').val();
                location.href = ('@Url.Action("Message", "ForumHome")' + '/' + id);
            });

        });

    </script>
}
